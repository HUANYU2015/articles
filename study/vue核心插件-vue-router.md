# [vue-router](https://router.vuejs.org/zh/guide/advanced/scroll-behavior.html#%E5%BC%82%E6%AD%A5%E6%BB%9A%E5%8A%A8)

## å®‰è£…

### ç›´æ¥ä¸‹è½½/CDN

### NPM 

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æˆ–æ˜¯ä½¿ç”¨vue-cliè‡ªåŠ¨å®‰è£…

~~~ xml
npm install vue-router
~~~

$æ£€æµ‹æµ‹è¯•ç®€ç­”æ”¯æŒåˆé€‚æ£€æµ‹ç»ˆäºç®€è¦å¿…é¡»çŸ¥é“è¾“å‡ºåŠ è½½$
~~æ£€æµ‹~~


å¦‚æœåœ¨ä¸€ä¸ªæ¨¡å—åŒ–å·¥ç¨‹ä¸­ä½¿ç”¨å®ƒï¼Œå¿…é¡»è¦é€šè¿‡Vue.use()æ˜ç¡®åœ°å®‰è£…è·¯ç”±åŠŸèƒ½ï¼š

~~~ javascript
import Vue from 'vue'
import VueRouter from 'vue-router'
Vue.use(VueRouter)
~~~

### æ„å»ºå¼€å‘æ¿

å¦‚æœä½ æƒ³ä½¿ç”¨æœ€æ–°çš„å¼€å‘ç‰ˆï¼Œä½ å¯ä»¥ä»GitHubä¸Šç›´æ¥cloneï¼Œç„¶åè‡ªå·±buildä¸€ä¸ªvue-router

~~~ xml
git clone https://github.com/vuejs/vue-router.git node_modules/vue-router
cd node_modules/vue-router
npm install
 run build
~~~

## ä»‹ç»

>### ç‰ˆæœ¬è¯´æ˜
>å¯¹äºTypeScriptç”¨æˆ·æ¥è¯´ï¼Œ**vue-router@3.0+**ä¾èµ–**vue@2.5+**ï¼Œåä¹‹äº¦ç„¶ã€‚

Vue Routeræ˜¯Vue.jså®˜æ–¹çš„è·¯ç”±ç®¡ç†å™¨ã€‚å®ƒå’ŒVue.jsçš„æ ¸å¿ƒæ·±åº¦é›†æˆï¼Œè®©æ„å»ºå•é¡µé¢åº”ç”¨å˜å¾—æ˜“å¦‚åæŒã€‚å®ƒå…·æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š

- åµŒå¥—çš„è·¯ç”±/è§†å›¾è¡¨
- æ¨¡å—åŒ–ã€åŸºäºç»„ä»¶çš„è·¯ç”±é…ç½®
- è·¯ç”±å‚æ•°ã€æŸ¥è¯¢ã€é€šé…ç¬¦
- åŸºäºVue.jsè¿‡åº¦ç³»ç»Ÿçš„è§†å›¾è¿‡åº¦æ•ˆæœ
- ç»†ç²’åº¦çš„å¯¼èˆªæ§åˆ¶
- å¸¦æœ‰è‡ªåŠ¨æ¿€æ´»çš„CSS classçš„é“¾æ¥
- HTML5å†å²æ¨¡å¼æˆ–hashæ¨¡å¼ï¼Œåœ¨IE9ä¸­è‡ªåŠ¨é™çº§
- **è‡ªåŠ¨çš„æ»šåŠ¨æ¡è¡Œä¸º**

## åŸºç¡€

### èµ·æ­¥

ä½¿ç”¨Vue.js+Vue Router åˆ›å»ºå•é¡µåº”ç”¨ï¼Œéå¸¸ç®€å•ã€‚ä½¿ç”¨Vue.jsï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç»„åˆç»„ä»¶æ¥æ„æˆåº”ç”¨ç¨‹åºï¼Œå½“ä½ è¦æŠŠVue Routeræ·»åŠ è¿›æ¥ï¼Œæˆ‘ä»¬éœ€è¦åšçš„æ˜¯ï¼š

- åœ¨/router.js/index.jsä¸­å°†ç»„ä»¶ï¼ˆcomponentï¼‰æ˜ å°„åˆ°è·¯ç”±ï¼ˆroutersï¼‰ï¼Œå³åˆ›å»ºè·¯ç”±å®ä¾‹ `VueRouter` ï¼Œå¹¶å®šä¹‰è·¯ç”± `routers`
- åœ¨ç¨‹åºå…¥å£æ–‡ä»¶ `main.js` ä¸­é€šè¿‡ `router` é€‰é¡¹æ³¨å…¥å‰é¢å·²åˆ›å»ºçš„è·¯ç”±å®ä¾‹
- åœ¨éœ€è¦ä½¿ç”¨è·¯ç”±çš„ç»„ä»¶ä¸­ä½¿ç”¨ `<router-link>` æ ‡ç­¾çš„ `to` å±æ€§æŒ‡å‘ç›¸å…³è·¯ç”±
- åœ¨é¡µé¢å…¥å£æ–‡ä»¶ï¼ˆ `App.vue` ï¼‰ä¸­ä½¿ç”¨ `<router-view>` æŒ‡æ˜è·¯ç”±å‡ºå£ï¼Œå³å‘ŠçŸ¥è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶çš„æ¸²æŸ“ä½ç½®

é€šè¿‡æ³¨å…¥è·¯ç”±å™¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä»»ä½•ç»„ä»¶å†…é€šè¿‡ `this.$router` è®¿é—®è·¯ç”±å™¨ï¼Œé€šè¿‡ `this.$route` è®¿é—®å½“å‰è·¯ç”±ã€‚

 > æ³¨æ„ï¼šå½“ `<router-link>` å¯¹åº”çš„è·¯ç”±åŒ¹é…æˆåŠŸï¼Œå°†è‡ªåŠ¨è®¾ç½®classå±æ€§å€¼ `.router-link-active` ã€‚

### åŠ¨æ€è·¯ç”±åŒ¹é…

æˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠæŸç§æ¨¡å¼åŒ¹é…åˆ°æ‰€æœ‰è·¯ç”±ï¼Œå…¨éƒ¨æ˜ å°„åˆ°åŒä¸€ä¸ªç»„ä»¶ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸€ä¸ª `User` ç»„ä»¶ï¼Œå¯¹äºæ‰€æœ‰IDå„ä¸ç›¸åŒçš„ç”¨æˆ·ï¼Œéƒ½è¦ä½¿ç”¨è¿™ä¸ªç»„ä»¶æ¥æ¸²æŸ“ã€‚é‚£ä¹ˆï¼Œä¸ºäº†å®ç°è¿™ä¸ªæ•ˆæœï¼Œå¯ä»¥åœ¨ `vue-router` çš„è·¯ç”±è·¯å¾„ä¸­ä½¿ç”¨ `åŠ¨æ€è·¯å¾„å‚æ•°ï¼ˆdynamic segmentï¼‰` ã€‚

 ```javascript
 const User = {
     template: '<div>User</div>'
 }

 const router = new VueRouter({
     routers: [
        // åŠ¨æ€è·¯å¾„å‚æ•° ä»¥å†’å·å¼€å¤´
         {path: '/user/:id', component: User}
     ]
 })
 ```

ç°åœ¨ï¼Œå‘ `/user/foo` å’Œ `/user/bar` éƒ½å°†æ˜ å°„åˆ°ç›¸åŒçš„è·¯ç”±ã€‚

ä¸€ä¸ª **è·¯å¾„å‚æ•°**ä½¿ç”¨ `:` æ ‡è®°ã€‚å½“åŒ¹é…åˆ°ä¸€ä¸ªè·¯ç”±æ—¶ï¼Œå‚æ•°å€¼ä¼šè¢«è®¾ç½®åˆ° `this.$route.params` ï¼Œå¹¶ä¸”å¯ä»¥åœ¨æ¯ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ–° `User` çš„æ¨¡æ¿ï¼Œè¾“å‡ºå½“å‰ç”¨æˆ·çš„IDï¼š

 ```javascript
 const User = {
     template: '<div>{{$route.params.id}}</div>'
 }
 ```

ä½ å¯ä»¥åœ¨ä¸€ä¸ªè·¯ç”±ä¸­è®¾ç½®å¤šæ®µ **è·¯å¾„å‚æ•°**ï¼Œå¯¹åº”çš„å€¼éƒ½ä¼šè®¾ç½®åˆ° `$route.params` ä¸­ã€‚ä¾‹å¦‚ï¼š
| æ¨¡å¼                          | åŒ¹é…è·¯å¾„            | $route.params                        |
| :---------------------------- | :------------------ | :----------------------------------- |
| /user/:username               | /user/evan          | `{username: â€˜evanâ€™}`               |
| /user/:username/post/:post_id | /user/evan/post/123 | `{username: 'evan', post_id: '123'}` |

é™¤äº† `$route.params` å¤–ï¼Œ `$route` å¯¹è±¡è¿˜æä¾›äº†å…¶ä»–æœ‰ç”¨çš„ä¿¡æ¯ï¼Œå¦‚ `$route.query` (å¦‚æœURLä¸­æœ‰æŸ¥è¯¢å‚æ•°)ã€ `$route.hash` ç­‰ç­‰ã€‚

#### å“åº”è·¯ç”±å‚æ•°çš„å˜åŒ–

å½“ä½¿ç”¨è·¯ç”±å‚æ•°æ—¶ï¼Œæ¯”å¦‚ä» `/user/foo` å¯¼èˆªåˆ° `/user/bar` ï¼Œ **åŸæ¥çš„ç»„ä»¶å®ä¾‹å°†ä¼šè¢«å¤ç”¨**ã€‚å› ä¸ºä¸¤ä¸ªè·¯ç”±éƒ½æ¸²æŸ“åŒä¸ªç»„ä»¶ï¼Œæ¯”èµ·é”€æ¯å†åˆ›å»ºï¼Œå¤ç”¨æ›´åŠ é«˜æ•ˆã€‚ **ä¸è¿‡ï¼Œè¿™ä¸ªæ„å‘³ç€ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸé’©å­ä¸ä¼šå†è¢«è°ƒç”¨**ã€‚

å¤ç”¨ç»„ä»¶æ—¶ï¼Œå¦‚éœ€å¯¹è·¯ç”±å‚æ•°çš„å˜åŒ–åšå‡ºå“åº”ï¼Œå¯ä»¥ç®€å•åœ°watch(æ£€æµ‹å˜åŒ–) `$route` å¯¹è±¡ï¼š

~~~ javascript
const User = {
    template: '...',
    watch: {
        '$route' (to, from) {
            // å¯¹è·¯ç”±å˜åŒ–åšå‡ºå“åº”...
        }
    }
}
~~~

æˆ–è€…ä½¿ç”¨2.2ä¸­å¼•å…¥çš„ `beforeRouteUpdate` **å¯¼èˆªå®ˆå«**ï¼š

~~~ javascript
const User = {
    template: '...',
    beforeRouteUpdate (to, from, next) {
        // react to route changes...
        // don't forget to call next()
    }
}
~~~

#### æ•è·æ‰€æœ‰è·¯ç”±æˆ–è€…404 Not foundè·¯ç”±

å¸¸è§„å‚æ•°åªä¼šåŒ¹é…è¢« `/` åˆ†éš”çš„URLç‰‡æ®µä¸­çš„å­—ç¬¦ã€‚å¦‚æœæƒ³åŒ¹é…ä»»æ„è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨é€šé…ç¬¦ï¼ˆ`*`ï¼‰ï¼š

~~~ javascript
{
    // ä¼šåŒ¹é…æ‰€æœ‰è·¯å¾„
    path: '*'
}, {
    // ä¼šåŒ¹é…ä»¥ â€˜ã€user-â€™å¼€å¤´çš„ä»»æ„è·¯å¾„
    path: '/user-*'
}
~~~

ä½¿ç”¨é€šé…ç¬¦è·¯ç”±éœ€è¦ç¡®ä¿è·¯ç”±çš„é¡ºåºæ˜¯æ­£ç¡®çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å«æœ‰é€šé…ç¬¦çš„è·¯ç”±åº”è¯¥æ”¾åœ¨æœ€åã€‚

è·¯ç”± `{path: '*'}` é€šå¸¸ç”¨äºå®¢æˆ·ç«¯**404é”™è¯¯**ã€‚å¦‚æœä½ ä½¿ç”¨äº†Historyæ¨¡å¼ï¼Œéœ€è¦ç¡®ä¿[æ­£ç¡®é…ç½®æœåŠ¡å™¨](#HTML\ Historyæ¨¡å¼)ã€‚

å½“ä½¿ç”¨ä¸€ä¸ªé€šé…ç¬¦æ—¶ï¼Œ`$route.params` ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªåä¸º `pathMatch` å‚æ•°ã€‚å®ƒåŒ…å«äº†URLé€šè¿‡é€šé…ç¬¦è¢«åŒ¹é…çš„éƒ¨åˆ†ï¼š

~~~ javascript
// ç»™å‡ºä¸€ä¸ªè·¯ç”± {path: 'user-*'}
this.$router.push('/user-admin')
this.$route.params.pathMatch // â€˜adminâ€™
// ç»™å‡ºä¸€ä¸ªè·¯ç”± {path: '*'}
this.$router.push('/non-existing')
this.$route.params.pathMatch // '/non-existing'
~~~

#### é«˜çº§åŒ¹é…æ¨¡å¼

`vue-router` ä½¿ç”¨**path-to-regexp**ä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ï¼Œæ‰€ä»¥æ”¯æŒå¾ˆå¤šé«˜çº§åŒ¹é…æ¨¡å¼ï¼Œå¦‚ï¼šå¯é€‰çš„åŠ¨æ€è·¯å¾„å‚æ•°ã€åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªã€ä¸€ä¸ªæˆ–å¤šä¸ªï¼Œç”šè‡³æ˜¯è‡ªå®šä¹‰æ­£åˆ™åŒ¹é…ã€‚å…·ä½“å¯ä»¥æŸ¥çœ‹å®ƒçš„[æ–‡æ¡£](https://github.com/pillarjs/path-to-regexp#parameters)å­¦ä¹ é«˜æ°çš„è·¯å¾„åŒ¹é…ï¼Œè¿˜æœ‰[è¿™ä¸ªä¾‹å­](https://github.com/vuejs/vue-router/blob/dev/examples/route-matching/app.js)å±•ç¤º `vue-router` æ€ä¹ˆä½¿ç”¨è¿™ç±»åŒ¹é…ã€‚

#### åŒ¹é…ä¼˜å…ˆçº§

æœ‰æ—¶ï¼ŒåŒä¸€ä¸ªè·¯å¾„å¯ä»¥åŒ¹é…å¤šä¸ªè·¯ç”±ï¼Œæ­¤æ—¶ï¼ŒåŒ¹é…çš„ä¼˜å…ˆçº§æŒ‰ç…§è·¯ç”±çš„å®šä¹‰é¡ºåºï¼šè°å…ˆå®šä¹‰çš„ï¼Œè°çš„ä¼˜å…ˆçº§å°±æ›´é«˜ã€‚

### åµŒå¥—è·¯ç”±

<!-- [æµ‹è¯•](#è¿›é˜¶) -->
å®é™…åº”ç”¨ç•Œé¢ï¼Œé€šå¸¸ç”±å¤šå±‚åµŒå¥—çš„ç»„ä»¶ç»„åˆè€Œæˆã€‚åŒæ ·ï¼ŒURLä¸­å„æ®µåŠ¨æ€è·¯å¾„ä¹ŸæŒ‰æŸç§ç»“æ„å¯¹åº”åµŒå¥—çš„å„å±‚ç»„ä»¶ï¼Œå¦‚ï¼š

~~~ javascript
/user/foo/profile                     /user/foo/posts
+------------------+                  +-----------------+
| User             |                  | User            |
| +--------------+ |                  | +-------------+ |
| | Profile      | |  +------------>  | | Posts       | |
| |              | |                  | |             | |
| +--------------+ |                  | +-------------+ |
+------------------+                  +-----------------+
~~~

å€ŸåŠ© `vue-router` ï¼Œä½¿ç”¨åµŒå¥—è·¯ç”±é…ç½®ï¼Œå°±å¯ä»¥å¾ˆç®€å•åœ°è¡¨è¾¾è¿™ç§å…³ç³»ã€‚

æ¥ç€ä¸ŠèŠ‚åˆ›å»ºçš„app:

~~~ html
<div id="app">
  <router-view></router-view>
</div>
~~~

~~~ javascript
const User = {
    template: '<div>User {{$route.params.id}}</div>'
}

const router = new VueRouter({
    routers: [
        {path: '/user/:id', component: User}
    ]
})
~~~

è¿™é‡Œçš„ `<router-view>` æ˜¯æœ€é¡¶å±‚çš„å‡ºå£ï¼Œæ¸²æŸ“æœ€é«˜çº§è·¯ç”±åŒ¹é…åˆ°çš„ç»„ä»¶ã€‚åŒæ ·çš„ï¼Œä¸€ä¸ªè¢«æ¸²æŸ“çš„ç»„ä»¶ä¹Ÿå¯ä»¥åŒ…å«è‡ªå·±çš„åµŒå¥— `<router-view>` ã€‚ä¾‹å¦‚ï¼Œåœ¨ `User` ç»„ä»¶çš„æ¨¡æ¿ä¸­æ·»åŠ ä¸€ä¸ª `<router-view>` ï¼š

~~~ javascript
const User = {
    template: '
        <div class="user">
            <h2>User {{$route.params.id}}</h2>
            <router-view></router-view>
        </div>
    '
}
~~~

è¦åœ¨åµŒå¥—çš„å‡ºå£ä¸­æ¸²æŸ“ç»„ä»¶ï¼Œéœ€è¦åœ¨ `VueRouter` çš„å‚æ•°ä¸­ä½¿ç”¨ `children` é…ç½®ï¼š

~~~ javascript
const router = new VueRouter({
    router: [
        {
            path: '/user/:id', component: User,
            children: [
                {
                    // å½“ /user/:id/profileåŒ¹é…æˆåŠŸ
                    // UserProfileä¼šè¢«æ¸²æŸ“åœ¨Userçš„<router-view>ä¸­
                    path: 'profile',
                    component: UserProfile
                }, {
                    // å½“/user/:id/postsåŒ¹é…æˆåŠŸ
                    // UserPostsä¼šè¢«æ¸²æŸ“åœ¨Userçš„<router-view>ä¸­
                    path: 'posts',
                    component: UserPosts
                }
            ]
        }
    ]
})
~~~

> æ³¨æ„ï¼šä»¥ `/` å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“åš**æ ¹è·¯å¾„**ã€‚è¿™è®©ä½ å……åˆ†åœ°ä½¿ç”¨åµŒå¥—ç»„ä»¶ï¼Œè€Œæ— é¡»è®¾ç½®åµŒå¥—è·¯å¾„ã€‚

`children` é…ç½®å°±åƒ `routers` é…ç½®ä¸€æ ·çš„è·¯å¾„é…ç½®å‚æ•°ï¼Œæ‰€ä»¥å¯ä»¥åµŒå¥—å¤šå±‚è·¯ç”±ã€‚

æ­¤æ—¶ï¼ŒåŸºäºä¸Šé¢çš„é…ç½®ï¼Œå½“è®¿é—® `/user/foo` æ—¶ï¼ŒUserçš„å‡ºå£æ˜¯ä¸ä¼šæ¸²æŸ“ä»»ä½•ä¸œè¥¿çš„ï¼Œå› ä¸ºæ²¡æœ‰åŒ¹é…åˆ°åˆé€‚çš„å­è·¯ç”±ã€‚å¦‚æœæƒ³è¦æ¸²æŸ“ç‚¹ä»€ä¹ˆï¼Œå¯ä»¥æä¾›ä¸€ä¸ªç©ºçš„å­è·¯ç”±ï¼š

~~~ javascript
const router = new VueRouter({
    routers: [
        {
            path: '/user/:id', component: User,
            children: [
                // å½“ /user/:id åŒ¹é…æˆåŠŸï¼Œ
                // UserHome ä¼šè¢«æ¸²æŸ“åœ¨ User çš„<router-view>ä¸­
                {path: '', component: UserHome}

                // ...å…¶ä»–å­è·¯ç”±
            ]
        }
    ]
})
~~~

æä¾›ä»¥ä¸Šæ¡ˆä¾‹çš„å¯è¿è¡Œä»£ç è¯·[**ç§»æ­¥è¿™é‡Œ**](https://jsfiddle.net/yyx990803/L7hscd8h/)ã€‚

### ç¼–ç¨‹å¼å¯¼èˆª

é™¤äº†ä½¿ç”¨ `<router-link>` åˆ›å»ºaæ ‡ç­¾æ¥å®šä¹‰å¯¼èˆªé“¾æ¥ï¼Œè¿˜å¯ä»¥å€ŸåŠ©routerçš„å®ä¾‹æ–¹æ³•ï¼Œé€šè¿‡ç¼–å†™ä»£ç æ¥å®ç°ã€‚

#### router.push(location, onComplete?, onAbort?)

> æ³¨æ„ï¼šåœ¨Vueå®ä¾‹å†…éƒ¨ï¼Œå¯ä»¥é€šè¿‡ `$router` è®¿é—®è·¯ç”±å®ä¾‹ã€‚å› æ­¤ä½ å¯ä»¥è°ƒç”¨ `this.$router.push` ã€‚

æƒ³è¦å¯¼èˆªåˆ°ä¸åŒçš„URLï¼Œåˆ™ä½¿ç”¨ `router.push` æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šå‘historyæ ˆæ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ğŸ“ã€‚æ‰€ä»¥ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨åé€€æŒ‰é’®æ—¶ï¼Œåˆ™å›åˆ°ä¹‹å‰çš„URLã€‚

å½“ä½ ç‚¹å‡» `<router-link>` æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåœ¨å†…éƒ¨è°ƒç”¨ï¼Œæ•…ç‚¹å‡» `<router-link :to="...">` ç­‰åŒä¸è°ƒç”¨ `router.push(...)` ã€‚

| **å£°æ˜å¼**                | **ç¼–ç¨‹å¼**         |
| :------------------------ | :----------------- |
| `<router-link :to="...">` | `router.push(...)` |

è¯¥æ–¹æ³•çš„å‚æ•°å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²è·¯å¾„ï¼Œæˆ–è€…ä¸€ä¸ªæè¿°åœ°å€çš„å¯¹è±¡ã€‚ä¾‹å¦‚ï¼š

~~~ javascript
// å­—ç¬¦ä¸² -> /home
router.push('home')

// å¯¹è±¡ -> /home
router.push({path: 'home'})

// å‘½åçš„è·¯ç”± -> /user/123
router.push({name: 'user', params: {userId: '123'}})

// å¸¦æŸ¥è¯¢å‚æ•°ï¼Œ -> /register?plan=private
router.push({path: 'register', query: {plan: 'private'}})
~~~

> æ³¨æ„ï¼šå¦‚æœæä¾›äº† **`path`**ï¼Œ**`params`** ä¼šè¢«å¿½ç•¥ï¼ˆä¸Šè¿°ä¾‹å­ä¸­çš„ `query` ä¸å±äºè¿™ç§æƒ…å†µï¼‰ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä»¥ä¸‹ä¸€äº›æ–¹å¼ä½œä¸ºæ›¿ä»£ï¼š

~~~ javascript
const userId = '123'
router.push({name: 'user', params: {userId}}) // -> /user/123
router.push({path: '/user/${userId}'}) // -> /user/123

// è¿™é‡Œçš„ params ä¸ç”Ÿæ•ˆ
router.push({path: '/user', params: {userId}}) // -> /user
~~~

åŒæ ·çš„è§„åˆ™ä¹Ÿé€‚ç”¨äº `router-link` ç»„ä»¶çš„ `to` å±æ€§ã€‚

åœ¨2.2.0+ï¼Œå‡½æ•° `router.push` å’Œ `router.replace` ä¸­ï¼Œæä¾›çš„ `onComplete` å’Œ `onAbort` å›è°ƒä½œä¸ºç¬¬äºŒã€ç¬¬ä¸‰ä¸ªå‚æ•°ã€‚å‰è€…å°†ä¼šåœ¨å¯¼èˆªæˆåŠŸå®Œæˆæ—¶ï¼ˆåœ¨æ‰€æœ‰çš„å¼‚æ­¥é’©å­è¢«è§£æä¹‹åï¼‰è¿›è¡Œç›¸åº”çš„è°ƒç”¨ï¼Œåè€…åœ¨å¯¼èˆªæˆåŠŸç»ˆæ­¢æ—¶ï¼ˆå¯¼èˆªåˆ°ç›¸åŒçš„è·¯ç”±ã€æˆ–åœ¨å½“å‰å¯¼èˆªå®Œæˆä¹‹å‰å¯¼èˆªåˆ°å¦ä¸€ä¸ªä¸åŒçš„è·¯ç”±ï¼‰è¿›è¡Œç›¸åº”çš„è°ƒç”¨ã€‚

#### router.replace(location, onComplete?, onAbort?)

è·Ÿ `router.push` å¾ˆåƒï¼Œä½ç§»çš„ä¸åŒå°±æ˜¯ï¼Œå®ƒä¸ä¼šåƒhistoryæä»·æ–°çºªå½•ï¼Œè€Œæ˜¯æ›¿æ¢æ‰å½“å‰çš„historyè®°å½•ã€‚

| **å£°æ˜å¼**                        | **ç¼–ç¨‹å¼**            |
| :-------------------------------- | :-------------------- |
| `<router-link :to="..." replace>` | `router.replace(...)` |

#### router.go(n)

è¿™ä¸ªæ–¹æ³•çš„å‚æ•°æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä½œç”¨æ˜¯åœ¨historyè®°å½•ä¸­å‘å‰åå‘åç§»åŠ¨næ­¥ï¼Œç±»ä¼¼ `window.histroy.go(n)` ã€‚

~~~ javascript
// åœ¨æµè§ˆå™¨è®°å½•ä¸­å‰è¿›ä¸€æ­¥ï¼Œç­‰åŒäºhistory.forword()
router.go(1)

// åé€€ä¸€æ­¥è®°å½•ï¼Œç­‰åŒäºhistory.back()
router.go(-1)

// å‰è¿› 3 æ­¥è®°å½•
router.go(3)

// å¦‚æœhistoryè®°å½•ä¸å¤Ÿç”¨ï¼Œå°±é»˜é»˜åœ°å¤±è´¥
router.go(-100)
router.go(100)
~~~

#### æ“ä½œHistory

æ³¨æ„ `router.push` `router.replace` å’Œ `router.go` ä¸`window.histroy.pushState` `window.history.replaceState` å’Œ  `window.history.go` æ¯”è¾ƒç›¸åƒï¼Œå®é™…ä¸Šå®ƒä»¬ç¡®å®å››æ•ˆä»¿ `window.history` **API**çš„ã€‚

æ­¤å¤–ï¼ŒVue Router çš„å¯¼èˆªæ–¹æ³•ï¼ˆpush/replace/goï¼‰åœ¨å„ç±»è·¯ç”±æ¨¡å¼ï¼ˆ`history` `hash`å’Œ`abstact`ï¼‰ä¸‹è¡¨ç°ä¸€è‡´ã€‚

### å‘½åè·¯ç”±

æœ‰æ—¶å€™ï¼Œé€šè¿‡ä¸€ä¸ªåç§°æ¥è¯†åˆ«ä¸€ä¸ªè·¯ç”±æ˜¾å¾—æ›´æ–¹ä¾¿ä¸€äº›ï¼Œç‰¹åˆ«æ˜¯åœ¨é“¾æ¥ä¸€ä¸ªè·¯ç”±ï¼Œæˆ–è€…æ‰§è¡Œä¸€äº›è·³è½¬çš„æ—¶å€™ã€‚å¯ä»¥åœ¨åˆ›å»ºRouterå®ä¾‹çš„æ—¶å€™ï¼Œåœ¨ routers é…ç½®ä¸­ç»™æŸä¸ªè·¯ç”±è®¾ç½®åç§°ã€‚

~~~ javascript
const router = new VueRouter({
    routers: [
        {
            path: '/user/:userId',
            name: 'user',
            component: User
        }
    ]
})
~~~

è¦é“¾æ¥ä¸€ä¸ªå‘½åè·¯ç”±ï¼Œå¯ä»¥ç»™ `router-link` çš„ `to` å±æ€§ä¼ ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡åŒ…å«ä¸€ä¸ª name å±æ€§ï¼š

~~~ javascript
// -> /user/123
<router-link :to="{name: 'user', params: {userId: 123}}">User</router-link>
~~~

ä¹Ÿå¯ä»¥ä½¿ç”¨ä»£ç å®ç°ï¼š

~~~ javascript
router.push({name: 'user', params: {userId: 123}})
~~~

è¿™ä¸¤ç§æ–¹å¼éƒ½ä¼šæŠŠè·¯ç”±å¯¼èˆªåˆ° `/user/123` è·¯å¾„ã€‚

å®Œæ•´ä¾‹å­è¯·[**ç§»æ­¥è¿™é‡Œ**](https://github.com/vuejs/vue-router/blob/dev/examples/named-routes/app.js)ã€‚

### å‘½åè§†å›¾

æœ‰æ—¶å€™éœ€è¦åŒæ—¶ï¼ˆåŒçº§ï¼‰å±•ç¤ºå¤šä¸ªè§†å›¾ï¼Œè€Œä¸æ˜¯åµŒå¥—æ˜¾ç¤ºï¼Œä¾‹å¦‚åˆ›å»ºä¸€ä¸ªé¡µé¢ï¼Œå…¶å¸ƒå±€æœ‰ sidebar ï¼ˆä¾§å¯¼èˆªï¼‰å’Œ main ï¼ˆä¸»å†…å®¹ï¼‰ä¸¤ä¸ªè§†å›¾ï¼Œè¿™ä¸ªæ—¶å€™å‘½åè§†å›¾ï¼ˆæ·»åŠ  `name` å±æ€§ï¼‰å°±æ´¾ä¸Šç”¨åœºäº†ã€‚ä½ å¯ä»¥åœ¨ç•Œé¢ä¸­æ‹¥æœ‰å¤šä¸ªå•ç‹¬å‘½åçš„è§†å›¾ï¼Œè€Œä¸æ˜¯å•ç‹¬ä¸€ä¸ªå‡ºå£ã€‚é»˜è®¤ï¼ˆ`default`ï¼‰è§†å›¾ï¼ˆrouter-viewï¼‰ï¼Œå¯æ— éœ€è®¾ç½®nameå±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š

~~~ html
<router-view class="view one"></router-view>
<router-view class="view two" name="a"></router-view>
<router-view class="view three" name="b"></router-view>
~~~

å•ä¸ªè§†å›¾ä½¿ç”¨å•ä¸ªç»„ä»¶æ¸²æŸ“ï¼Œå› æ­¤å¯¹äº`åŒä¸€ä¸ªè·¯ç”±`ï¼Œå¤šä¸ªè§†å›¾å°±éœ€è¦å¤šä¸ªç»„ä»¶ã€‚ç¡®ä¿æ­£ç¡®ä½¿ç”¨ `components` é…ç½®ï¼ˆå¤æ•°ï¼‰

~~~ javascript
const router = new VueRouter({
    routers: [
        {
            path: '/',
            components: {
                default: Foo,
                a: Bar,
                b: Baz
            }
        }
    ]
})
~~~

ä»¥ä¸Šæ¡ˆä¾‹ç›¸å…³å¯è¿è¡Œä»£ç è¯·[**ç§»æ­¥è¿™é‡Œ**](https://jsfiddle.net/posva/6du90epg/)

#### åµŒå¥—å‘½åè§†å›¾

å½“é¡µé¢å¸ƒå±€æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯èƒ½éœ€è¦ä½¿ç”¨å‘½åè§†å›¾åˆ›å»ºè§†å›¾åµŒå¥—ã€‚éœ€è¦ç»“åˆåµŒå¥—è·¯ç”±å’Œå‘½åè§†å›¾æ¥å®ç°ã€‚ä»¥ä¸€ä¸ªè®¾ç½®é¢æ¿ä¸ºä¾‹ï¼š

~~~ javascript
/settings/emails                                       /settings/profile
+-----------------------------------+                  +------------------------------+
| UserSettings                      |                  | UserSettings                 |
| +-----+-------------------------+ |                  | +-----+--------------------+ |
| | Nav | UserEmailsSubscriptions | |  +------------>  | | Nav | UserProfile        | |
| |     +-------------------------+ |                  | |     +--------------------+ |
| |     |                         | |                  | |     | UserProfilePreview | |
| +-----+-------------------------+ |                  | +-----+--------------------+ |
+-----------------------------------+                  +------------------------------+
~~~

`Nav` åªæ˜¯ä¸€ä¸ªå¸¸è§„ç»„ä»¶ã€‚
`UserSettings` æ˜¯ä¸€ä¸ªè§†å›¾ç»„ä»¶ã€‚
`UserEmailSubscriptions`ã€`UserProfile`ã€`UserProfilePreview` æ˜¯åµŒå¥—çš„è§†å›¾ç»„ä»¶ã€‚

`UserSettings` ç»„ä»¶ä»£ç å¦‚ä¸‹ï¼š

~~~ javascript
const UserSettings = {
    template: `
    <div class="us">
        <h2>User Settings</h2>
        <UserSettingsNav/>
        <router-view class ="us__content"/>
        <router-view name="helper" class="us__content us__content--helper"/>
</div>
    `,
  components: { UserSettingsNav }
}
~~~

ç„¶åé€šè¿‡è·¯ç”±é…ç½®å®Œæˆå¸ƒå±€ï¼š

~~~ javascript
const router = new VueRouter({
    mode: 'history',
    routers: [
        {
            path: '/settings',
            component: UserSettings,
            children: [{
                path: 'emails',
                component: UserEmailSubscriptions
            }, {
                path: 'profile',
                components: {
                    default: UserProfile,
                    helper: UserProfilePreview
                }
            }]
        }
    ]
})
~~~

ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹è¯·[**ç§»æ­¥è¿™é‡Œ**](https://jsfiddle.net/posva/22wgksa3/)

### é‡å®šå‘å’Œåˆ«å

#### é‡å®šå‘

é‡å®šå‘ä¹Ÿæ˜¯é€šè¿‡ `routers` é…ç½®æ¥å®Œæˆçš„ï¼Œä¸‹é¢çš„ä¾‹å­æ˜¯ä» `/a` é‡å®šå‘åˆ° `/b` ï¼š

~~~ javascript
const router = new VueRouter({
    routers: [
        {path: '/a', redirect: '/b'}
    ]
})
~~~

é‡å®šå‘çš„ç›®æ ‡ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå‘½åçš„è·¯ç”±ï¼š

~~~ javascript
const router = new VueRouter({
    routers: [
        {path: '/a', redirect: {name: 'foo'}}
    ]
})
~~~

ç”šè‡³æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•è¿”å›é‡å®šå‘ç›®æ ‡ï¼š

~~~ javascript
const router = new VueRouter({
    routers: [
        {path: '/a', redirect: to => {
            // æ–¹æ³•æ¥æ”¶ ç›®æ ‡è·¯ç”± ä½œä¸ºå‚æ•°
            // return é‡å®šå‘çš„ å­—ç¬¦ä¸²è·¯å¾„æˆ–è·¯å¾„å¯¹è±¡
        }}
    ]
})
~~~

> æ³¨æ„[å¯¼èˆªå®ˆå«](#å¯¼èˆªå®ˆå«)å¹¶æ²¡æœ‰åº”ç”¨åœ¨è·³è½¬è·¯ç”±ä¸Šï¼Œè€Œä»…ä»…åº”ç”¨åœ¨å…¶ç›®æ ‡ä¸Šã€‚åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸º /a è·¯ç”±æ·»åŠ ä¸€ä¸ª beforeEach æˆ– beforeLeave å®ˆå«å¹¶ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚
>
> å…¶å®ƒé«˜çº§ç”¨æ³•ï¼Œè¯·å‚è€ƒ[**ä¾‹å­**](https://github.com/vuejs/vue-router/blob/dev/examples/redirect/app.js)ã€‚

#### åˆ«å

â€œé‡å®šå‘â€å³ï¼Œå½“ç”¨æˆ·è®¿é—® `/a` æ—¶ï¼ŒURLå°†ä¼šè¢«æ›¿æ¢æˆ `/b` ï¼Œç„¶ååŒ¹é…è·¯ç”±ä¸º `/b` ã€‚
è€Œåˆ«åçš„è·¯ç”±åŒ¹é…åˆ™ä¿æŒä¸å˜ã€‚ä¾‹å¦‚ï¼Œ**`/a` çš„åˆ«åæ˜¯ `/b` ï¼Œæ„å‘³ç€ï¼Œå½“ç”¨æˆ·è®¿é—® `/b` æ—¶ï¼ŒURLä¼šä¿æŒä¸º `/b` ï¼Œä½†æ˜¯è·¯ç”±åŒ¹é…åˆ™ä¸º `/a` ï¼Œå°±åƒç”¨æˆ·è®¿é—® `/a` ä¸€æ ·**ã€‚

ä¸Šé¢å¯¹åº”çš„è·¯ç”±é…ç½®ä¸ºï¼š

~~~ javascript
const router = new VueRouter({
    routers: [
        {path: '/a', component: A, alias: '/b'}
    ]
})
~~~

å€ŸåŠ©â€œåˆ«åâ€ï¼Œä½ å¯ä»¥ä¸å¿…å—é™äºé…ç½®çš„åµŒå¥—è·¯ç”±ç»“æ„ï¼Œè€Œè‡ªç”±åœ°å°†UIç»“æ„æ˜ å°„åˆ°ä»»æ„çš„URLã€‚
æ›´å¤šé«˜çº§ç”¨æ³•ï¼Œè¯·[ç§»æ­¥ä¾‹å­](https://github.com/vuejs/vue-router/blob/dev/examples/route-alias/app.js)

### è·¯ç”±ç»„ä»¶ä¼ å‚

åœ¨ç»„ä»¶ä¸­ï¼Œä½¿ç”¨ `$route` ä¼šä½¿è¯¥ç»„ä»¶ä¸å…¶å¯¹åº”çš„è·¯ç”±å½¢æˆé«˜åº¦è€¦åˆï¼Œä»è€Œä½¿ç»„ä»¶åªèƒ½åœ¨æŸäº›ç‰¹å®šçš„URLä¸Šä½¿ç”¨ï¼Œé™åˆ¶äº†ç»„ä»¶çš„çµæ´»ä½¿ç”¨ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ `props` å°†ç»„ä»¶å’Œè·¯ç”±è§£è€¦ï¼š

**ä¸ `$route` è€¦åˆ**

~~~ javascript
const User = {
    template: '<div>User {{$route.params.id}}</div>'
}
const router = new VueRouter({
    routers: [
        {path: '/user/:id', component: User}
    ]
})
~~~

**é€šè¿‡ `props` è§£è€¦**

~~~ javascript
const User = {
    props: ['id'],
    template: '<div>User {{id}}</div>'
}

const router = new VueRouter({
    routers: [
        {path: '/user/:id', component: User, props: true},

        // å¯¹äºåŒ…å«å‘½åè§†å›¾çš„è·¯ç”±ï¼Œä½ å¿…é¡»åˆ†åˆ«ä¸ºæ¯ä¸ªå‘½åè§†å›¾è®¾ç½® â€˜propsâ€™é€‰é¡¹ï¼š
        {
            path: '/user/:id',
            components: {default: User, sidebar: Sidebar},
            props: {default: true, sidebar: false}
        }
    ]
})
~~~

è¿™æ ·ä½ ä¾¿å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ä½¿ç”¨è¯¥ç»„ä»¶ï¼Œä½¿å¾—è¯¥ç»„ä»¶æ›´æ˜“äºé‡ç”¨å’Œæµ‹è¯•ã€‚

#### å¸ƒå°”æ¨¡å¼

å¦‚æœ `props` è¢«è®¾ç½®ä¸º `true` ï¼Œ`route.params` å°†ä¼šè¢«è®¾ç½®ä¸ºç»„ä»¶å±æ€§ã€‚

#### å¯¹è±¡æ¨¡å¼

å¦‚æœ `props` æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä¼šæŒ‰åŸæ ·è®¾ç½®ä¸ºç»„ä»¶å±æ€§ã€‚å½“ `props`æ˜¯é™æ€ï¼ˆå­—ç¬¦ä¸²ï¼‰çš„æ—¶å€™æœ‰ç”¨ã€‚

~~~ javascript
const router = new VueRouter({
    routers: [
        {path: '/promotion/from-newletter', component: Promotion, props: {newletterPopup: false}}
    ]
})
~~~

#### å‡½æ•°æ¨¡å¼

å¯ä»¥åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å› `props` ã€‚ä»è€Œä¾¿å¯ä»¥å°†å‚æ•°è½¬æ¢æˆå¦ä¸€ç§ç±»å‹ï¼Œæ¯”å¦‚å¯ä»¥å°†é‡‘æ³°å€¼ä¸åŸºäºè·¯ç”±çš„å‚æ•°ç»“åˆç­‰ç­‰ã€‚

~~~ javascript
const router = new VueRouter({
    router: [
        {
            path: '/search', component: SearchUser, props: (route) => ({query: route.query.q})
        }
    ]
})
~~~

URL `/search?q=vue` ä¼šå°† `{query: 'vue'}` ä½œä¸ºå±æ€§ä¼ é€’ç»™ `SearchUser` ç»„ä»¶ã€‚

> æ³¨æ„: è¯·å°½å¯èƒ½ä¿æŒ `props` å‡½æ•°ä¸º[**æ— çŠ¶æ€**][3]çš„ï¼Œå› ä¸ºå®ƒåªä¼šåœ¨è·¯ç”±å‘ç”Ÿå˜åŒ–æ—¶èµ·ä½œç”¨ã€‚å¦‚æœä½ éœ€è¦çŠ¶æ€æ¥å®šä¹‰ `props` ï¼Œè¯·ä½¿ç”¨**åŒ…è£…ç»„ä»¶**ï¼Œè¿™æ ·Vueæ‰å¯ä»¥å¯¹çŠ¶æ€å˜åŒ–ä½œå‡ºååº”ã€‚

è¯¦ç»†ç”¨æ³•ï¼Œè¯·æŸ¥çœ‹[ä¾‹å­]æˆ–ä¸‹é¢ä»£ç (https://github.com/vuejs/vue-router/blob/dev/examples/route-props/app.js)

~~~ javascript
import Vue from 'vue'
import VueRouter from 'vue-router'
import Hello from './Hello.vue'

Vue.use(VueRouter)

function dynamicPropsFn (route) {
  const now = new Date()
  return {
    name: (now.getFullYear() + parseInt(route.params.years)) + '!'
  }
}

const router = new VueRouter({
  mode: 'history',
  base: __dirname,
  routes: [
    { path: '/', component: Hello }, // No props, no nothing
    { path: '/hello/:name', component: Hello, props: true }, // Pass route.params to props
    { path: '/static', component: Hello, props: { name: 'world' }}, // static values
    { path: '/dynamic/:years', component: Hello, props: dynamicPropsFn }, // custom logic for mapping between route and props
    { path: '/attrs', component: Hello, props: { name: 'attrs' }}
  ]
})

new Vue({
  router,
  template: `
    <div id="app">
      <h1>Route props</h1>
      <ul>
        <li><router-link to="/">/</router-link></li>
        <li><router-link to="/hello/you">/hello/you</router-link></li>
        <li><router-link to="/static">/static</router-link></li>
        <li><router-link to="/dynamic/1">/dynamic/1</router-link></li>
        <li><router-link to="/attrs">/attrs</router-link></li>
      </ul>
      <router-view class="view" foo="123"></router-view>
    </div>
  `
}).$mount('#app')
~~~

### HTML Historyæ¨¡å¼

 å‚è€ƒ:</br>
[ä¸€](https://juejin.im/post/5a61908c6fb9a01c9064f20a)</br>
[äºŒ](https://juejin.im/post/5b31a4f76fb9a00e90018cee)</br>
[ä¸‰](https://www.jianshu.com/p/3fcae6a4968f)

#### ä¸ºä»€ä¹ˆè¦æœ‰hash å’Œ history

å¯¹äºVueè¿™ç±»æ¸è¿›å¼å‰ç«¯å¼€å¤§æ¡†æ¶ï¼Œä¸ºäº†æ„å»ºSPAï¼ˆå•é¡µé¢åº”ç”¨ï¼‰ï¼Œéœ€è¦å¼•å…¥**å‰ç«¯è·¯ç”±ç³»ç»Ÿ**ï¼Œè¿™ä¹Ÿæ˜¯Vue_routerå­˜åœ¨çš„æ„ä¹‰ã€‚å‰ç«¯è·¯ç”±çš„æ ¸å¿ƒï¼Œå°±åœ¨äº--**æ”¹å˜è§†å›¾çš„åŒæ—¶ä¸ä¼šå‘åç«¯å‘å‡ºè¯·æ±‚**ã€‚

ä¸ºäº†è¾¾åˆ°è¿™ä¸€ç›®çš„ï¼Œå½“å‰æµè§ˆå™¨æä¾›äº†ä¸€ä¸‹ä¸¤ç§æ”¯æŒï¼š

1. **`hash`**--å³åœ°å€æ URLä¸­çš„ `#` ç¬¦å·ï¼ˆæ­¤hashä¸æ˜¯å¯†ç å­¦é‡Œçš„æ•£åˆ—è¿ç®—)ã€‚</br>æ¯”å¦‚è¿™ä¸ªURL: `http://www.abc.com/#/hello` ï¼Œhashçš„å€¼ä¸º `#/hello` ã€‚å®ƒçš„ç‰¹ç‚¹åœ¨äºï¼šhashè™½ç„¶å‡ºç°åœ¨URLä¸­ï¼Œä½†ä¸ä¼šè¢«åŒ…æ‹¬åœ¨HTTPè¯·æ±‚ä¸­ï¼Œå¯¹åç«¯å®Œå…¨æ²¡æœ‰å½±å“ï¼Œå› æ­¤**æ”¹å˜hashä¸ä¼šé‡æ–°åŠ è½½é¡µé¢**ã€‚
2. **`history`**--åˆ©ç”¨äº†HTML5 History Interface ä¸­æ–°å¢çš„ `pushState()` å’Œ `replaceState()` æ–¹æ³•ï¼ˆéœ€ç‰¹å®šæµè§ˆå™¨æ”¯æŒï¼‰ã€‚</br>è¿™ä¸¤ä¸ªæ–¹æ³•åº”ç”¨äºæµè§ˆå™¨çš„å†å²è®°å½•æ ˆï¼Œåœ¨å½“å‰å·²æœ‰çš„ `back`ã€ `forward`ã€`go` çš„åŸºç¡€ä¹‹ä¸Šï¼Œå®ƒä»¬æä¾›äº†å¯¹å†å²è®°å½•è¿›è¡Œä¿®æ”¹çš„åŠŸèƒ½ã€‚åªæ˜¯å½“å®ƒä»¬æ‰§è¡Œä¿®æ”¹æ—¶ï¼Œè™½ç„¶å½“å‰URLè¢«æ”¹å˜äº†ï¼Œä½†æ˜¯æµè§ˆå™¨ä¸ä¼šç«‹å³å‘åç«¯å‘é€è¯·æ±‚ã€‚

å› æ­¤å¯ä»¥è¯´ï¼Œhashæ¨¡å¼å’Œhistoryæ¨¡å¼éƒ½å±äºæµè§ˆå™¨è‡ªèº«çš„å±æ€§ï¼ŒVue-Routeråªæ˜¯åˆ©ç”¨äº†è¿™ä¸¤ä¸ªç‰¹æ€§æ¥å®ç°å‰ç«¯è·¯ç”±ï¼ˆé€šè¿‡è°ƒç”¨æµè§ˆå™¨æä¾›çš„æ¥å£ï¼‰ã€‚

#### hashæ¨¡å¼

hashæ¨¡å¼èƒŒåçš„åŸç†æ˜¯ `onhashchange` äº‹ä»¶ï¼Œå¯ä»¥åœ¨windowå¯¹è±¡ä¸Šç›‘å¬è¿™ä¸ªäº‹ä»¶ï¼š

~~~ javascript
window.onhashchange = function(event) {
    console.log(event.oldURL, event.newURL);
    let hash = location.hash.slice(1);
    document.body.style.color = hash;
}
~~~

ä¸Šé¢çš„diamanteå¯ä»¥å®ç°é€šè¿‡æ”¹å˜hashæ¥æ”¹å˜é¡µé¢å­—ä½“é¢œè‰²çš„åŠŸèƒ½ï¼Œå¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šè¯´æ˜hashçš„åŸç†ã€‚

æ›´å…³é”®çš„ä¸€ç‚¹æ˜¯ï¼Œå› ä¸ºhashå‘ç”Ÿå˜åŒ–çš„URLéƒ½ä¼šè¢«æµè§ˆå™¨è®°å½•ä¸‹æ¥ï¼Œä»è€Œæµè§ˆå™¨çš„å‰è¿›åé€€éƒ½å¯ä»¥ä½¿ç”¨äº†ã€‚åŒæ—¶ç‚¹å‡»åé€€æ—¶ï¼Œé¡µé¢å­—ä½“é¢œè‰²ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™æ ·ä¸€æ¥ï¼Œå°½ç®¡æµè§ˆå™¨æ²¡æœ‰è¯·æ±‚æœåŠ¡å™¨ï¼Œé¡µé¢é¢œè‰²ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–ï¼Œä½†æ˜¯é¡µé¢çŠ¶æ€å’ŒURLä¸€ä¸€å…³è”èµ·æ¥äº†ã€‚

#### historyæ¨¡å¼åº”ç”¨åœºæ™¯

ä¸€èˆ¬åœºæ™¯ä¸‹ï¼Œhash å’Œ history éƒ½å¯ä»¥ï¼Œé™¤éä½ æ›´åœ¨æ„é¢œå€¼ï¼Œ`#` ç¬¦å·å¤¹æ‚åœ¨URLé‡Œçœ‹èµ·æ¥ç¡®å®ä¸å¤ªç¾è§‚ã€‚

å¦å¤–ï¼Œæ ¹æ® [Mozilla Develop Network][4]çš„ä»‹ç»ï¼Œè°ƒç”¨ `history.pushState()` ç›¸æ¯”äºç›´æ¥ä¿®æ”¹ `hash` ï¼Œå­˜åœ¨ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- `pushState()` è®¾ç½®çš„æ–°URLå¯ä»¥ä½¿ä¸å½“å‰URL**åŒæº**çš„ä»»æ„URLï¼›è€Œ `hash` åªå¯ä¿®æ”¹ `#` åé¢çš„éƒ¨åˆ†ï¼Œå› æ­¤åªèƒ½è®¾ç½®ä¸å½“å‰URL**åŒæ–‡æ¡£**çš„URLï¼›
- `pushState()` è®¾ç½®æ–°çš„URLå¯ä»¥ä¸å½“å‰URLä¸€æ¨¡ä¸€æ ·ï¼Œè¿™æ ·ä¹Ÿä¼šæŠŠè®°å½•æ·»åŠ åˆ°æ ˆä¸­ï¼›è€Œ `hash` è®¾ç½®çš„æ–°å€¼å¿…é¡»ä¸åŸæ¥ä¸ä¸€æ ·æ‰ä¼šè§¦å‘åŠ¨ä½œå°†è®°å½•æ·»åŠ åˆ°æ ˆä¸­ï¼›
- `pushState()` é€šè¿‡ `stateObject` å‚æ•°å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹çš„æ•°æ®åˆ°è®°å½•ä¸­ï¼›è€Œ `hash` åªå¯æ·»åŠ ç«¯å­—ç¬¦ä¸²ï¼›
- `pushState()` å¯é¢å¤–è®¾ç½® `title`å±æ€§ä¾›åç»­ä½¿ç”¨ã€‚

å½“ç„¶ï¼Œ`history` æ¨¡å¼ä¹Ÿä¸æ˜¯æ²¡æœ‰ç¼ºé™·ã€‚SPAè™½ç„¶åœ¨æµè§ˆå™¨ä¸­æ¸¸åˆƒæœ‰ä½™ï¼Œä½†æ˜¯å½“çœŸè¦é€šè¿‡URLå‘åç«¯å‘èµ·HTTPè¯·æ±‚æ—¶ï¼Œä¸¤è€…çš„å·®å¼‚å°±è¡¨ç°å‡ºæ¥äº†ã€‚å°¤å…¶åœ¨ç”¨æˆ·æ‰‹åŠ¨è¾“å…¥URLåå›è½¦ï¼Œæˆ–è€…åˆ·æ–°ï¼ˆé‡å¯ï¼‰æµè§ˆå™¨çš„æ—¶å€™ã€‚

1. `hash` æ¨¡å¼ä¸‹ï¼Œä»… `hash` ç¬¦å·ä¹‹å‰çš„å†…å®¹ä¼šè¢«åŒ…å«åœ¨è¯·æ±‚ä¸­ï¼Œå¦‚ `http://www.abc.com` ï¼Œå› æ­¤å¯¹äºåç«¯æ¥è¯´ï¼Œå³ä½¿æ²¡æœ‰åšåˆ°å¯¹è·¯ç”±çš„å…¨è¦†ç›–ï¼Œä¹Ÿä¸ä¼šè¿”å›404é”™è¯¯ã€‚
2. `history` æ¨¡å¼ä¸‹ï¼Œå‰ç«¯çš„URLå¿…é¡»å’Œå®é™…å‘åç«¯å‘èµ·è¯·æ±‚çš„URLä¸€è‡´ï¼Œå¦‚ `http://www.abc.com/book/id`ã€‚å¦‚æœåç«¯ç¼ºå°‘å¯¹ `/book/id` çš„è·¯ç”±å¤„ç†ï¼Œå°†è¿”å›404é”™è¯¯ã€‚

å› æ­¤ï¼ŒVue-Routerå®˜ç½‘é‡Œå¦‚æ­¤æè¿°ï¼šâ€œ**ä¸è¿‡è¿™ç§æ¨¡å¼è¦ç©å¥½ï¼Œè¿˜éœ€è¦åå°é…ç½®æ”¯æŒ**......æ‰€ä»¥ä½ è¦åœ¨æœåŠ¡ç«¯å¢åŠ ä¸€ä¸ªè¦†ç›–æ‰€æœ‰æƒ…å†µçš„å€™é€‰èµ„æºï¼šå¦‚æœURLåŒ¹é…ä¸åˆ°ä»»ä½•é™æ€èµ„æºï¼Œåˆ™åº”è¯¥è¿”å›åŒä¸€ä¸ªindex.htmlé¡µé¢ï¼Œè¿™ä¸ªé¡µé¢å°±æ˜¯ä½ APPä¾èµ–çš„é¡µé¢ã€‚â€

#### åç«¯é…ç½®ä¾‹å­

// todo å¾…ç»­ï¼*****å¾…ç»­*****

$nginx$

$åŸç”ŸNode.js$

$åŸºäºNode.jsçš„Express$

$InternetInformation Servicesï¼ˆIISï¼‰$

$Caddy$

$Firebaseä¸»æœº$

#### è­¦å‘Šâš ï¸

ç»™ä¸ªè­¦å‘Šï¼Œå› ä¸ºè¿™ä¹ˆåšä»¥åï¼ŒæœåŠ¡å™¨å°±ä¸å†è¿”å› 404 é”™è¯¯é¡µé¢ï¼Œå› ä¸ºå¯¹äºæ‰€æœ‰è·¯å¾„éƒ½ä¼šè¿”å› index.html æ–‡ä»¶ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œä½ åº”è¯¥åœ¨ Vue åº”ç”¨é‡Œé¢è¦†ç›–æ‰€æœ‰çš„è·¯ç”±æƒ…å†µï¼Œç„¶ååœ¨ç»™å‡ºä¸€ä¸ª 404 é¡µé¢ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š

~~~ javascript
const router = new VueRouter({
    mode: 'history',
    routers: [
        {path: '*', component: NotFoundComponent}
    ]
})
~~~

æˆ–è€…ï¼Œå¦‚æœä½ ä½¿ç”¨ Node.js æœåŠ¡å™¨ï¼Œä½ å¯ä»¥ç”¨æœåŠ¡ç«¯è·¯ç”±åŒ¹é…åˆ°æ¥çš„ URLï¼Œå¹¶åœ¨æ²¡æœ‰åŒ¹é…åˆ°è·¯ç”±çš„æ—¶å€™è¿”å› 404ï¼Œä»¥å®ç°å›é€€ã€‚æ›´å¤šè¯¦æƒ…è¯·æŸ¥é˜… [Vue æœåŠ¡ç«¯æ¸²æŸ“æ–‡æ¡£][5]ã€‚

## è¿›é˜¶

### å¯¼èˆªå®ˆå«

### è·¯ç”±å…ƒä¿¡æ¯

### è¿‡åº¦åŠ¨æ•ˆ

### æ•°æ®è·å–

### æ»šåŠ¨è¡Œä¸º

ä½¿ç”¨å‰ç«¯è·¯ç”±ï¼Œå½“åˆ‡æ¢åˆ°æ–°è·¯ç”±æ—¶ï¼Œæƒ³è¦é¡µé¢æ»šåˆ°é¡¶éƒ¨æˆ–è€…æ˜¯å°±åƒé‡æ–°åŠ è½½é¡µé¢é‚£æ ·ä¿æŒåŸå…ˆçš„æ»šåŠ¨ä½ç½®ã€‚vue-routerèƒ½åšåˆ°ï¼Œè€Œä¸”æ›´å¥½ï¼Œå®ƒè®©ä½ å¯ä»¥è‡ªå®šä¹‰è·¯ç”±åˆ‡æ¢æ—¶é¡µé¢å¦‚ä½•æ»šåŠ¨ã€‚

**æ³¨æ„ï¼šè¿™ä¸ªåŠŸèƒ½åªåœ¨æ”¯æŒ `history.pushState` çš„æµè§ˆå™¨ä¸­å¯ç”¨ã€‚**

å½“åˆ›å»ºä¸€ä¸ªRouterå®ä¾‹ï¼Œä½ å¯ä»¥æä¾›ä¸€ä¸ª `scrollBehavior` æ–¹æ³•ï¼š

~~~ javascript
const router = new VueRouter({
    router: [...],
    scrollBehavior (to, from, savedPosition) {
        // return æœŸæœ›æ»šåŠ¨åˆ°é‚£ä¸ªä½ç½®
    }
})
~~~

`scrollBehavior` æ–¹æ³•æ¥æ”¶ `to` å’Œ `from` è·¯ç”±å¯¹è±¡ã€‚ç¬¬ä¸‰ä¸ªå‚æ•° `savedPosition` å½“ä¸”ä»…å½“ `popstate` å¯¼èˆªï¼ˆé€šè¿‡æµè§ˆå™¨çš„**å‰è¿›/åé€€**æŒ‰é’®è§¦å‘ï¼‰æ—¶æ‰å¯ç”¨ã€‚
è¿™ä¸ªæ–¹æ³•è¿”å›æ»šåŠ¨ä½ç½®çš„å¯¹è±¡ä¿¡æ¯ï¼Œå¦‚ï¼š

- `{x: number, y: number}`
- `{selector: string, offset? : {x: number, y: number}}`(offsetåªåœ¨2.6.0+æ”¯æŒ)

å¦‚æœè¿”å›ä¸€ä¸ªfalsyçš„å€¼ï¼Œæˆ–è€…æ˜¯ä¸€ä¸ªç©ºå¯¹è±¡ï¼Œé‚£ä¹ˆä¸ä¼šå‘ç”Ÿæ»šåŠ¨ã€‚
ä¾‹å¦‚ï¼š

~~~ javascript
scrollBehavior ï¼ˆto, from, savedPositionï¼‰ {
    return {x: 0, y: 0}
}
~~~

å¯¹äºæ‰€æœ‰è·¯ç”±å¯¼èˆªï¼Œç®€å•åœ°è®©é¡µé¢æ»šåŠ¨åˆ°é¡µé¢é¡¶éƒ¨ã€‚

è¿”å› `savedPosition` ï¼Œåœ¨æŒ‰ä¸‹**åé€€/å‰è¿›**æŒ‰é’®æ—¶ï¼Œå°±ä¼šæƒ³æµè§ˆå™¨çš„åŸç”Ÿè¡¨ç°é‚£æ ·ï¼š

~~~ javascript
scrollBehavior (to, from, savedPosition) {
    if (savedPosition) {
        return savedPosition
    } else {
        return {x: 0, y: 0}
    }
}
~~~

å¦‚æœä½ è¦æ¨¡æ‹Ÿâ€œæ»šåŠ¨åˆ°é”šç‚¹â€çš„è¡Œä¸ºï¼Œåˆ™å¯å¦‚ä¸‹ç¼–å†™ä»£ç ï¼š

~~~ javascript
scrollBehavior (to, from, savedPosition) {
    if (to.hash) {
        return {
            selector: to.hash
        }
    }
}
~~~

æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨[è·¯ç”±å…ƒä¿¡æ¯][1]æ›´ç»†é¢—ç²’åº¦åœ°æ§åˆ¶æ»šåŠ¨ã€‚æŸ¥çœ‹å®Œæ•´ä¾‹å­è¯·[ç§»æ­¥è¿™é‡Œ][2]ã€‚

[1]:https://segmentfault.com/a/1190000012578301
[2]:https://github.com/vuejs/vue-router/blob/next/examples/scroll-behavior/app.js
[3]:https://endual.iteye.com/blog/1340359
[4]:https://developer.mozilla.org/zh-CN/docs/Web
[5]:https://ssr.vuejs.org/zh/

### è·¯ç”±æ‡’åŠ è½½
